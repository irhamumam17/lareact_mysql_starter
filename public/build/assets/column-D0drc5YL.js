import{j as t,c as N,b as K,L as _}from"./app-BuL0pVBZ.js";import{r as b}from"./index-Berc4nBE.js";import{d as x}from"./dayjs.min-XX-0z4Zn.js";import{r as w}from"./relativeTime-CPppplC_.js";import{B as u}from"./badge-8L__yrnq.js";import{A,a as P,b as U}from"./arrow-up-ByAyNCsC.js";/* empty css            */import"./index-CMWG4mbA.js";import"./index-7uOuBa2-.js";import"./utils-D0Zg16Wk.js";import"./createLucideIcon-DK5M6DL3.js";function g(s){const e=N.c(14),{label:r,columnKey:l}=s,m=K().url??"";let a,n,o;if(e[0]!==l||e[1]!==m){const p=new URLSearchParams(m.split("?")[1]??""),j=p.get("sort")??"",h=(p.get("direction")??"desc").toLowerCase(),y=p.get("per_page")??"",f=j===l,v=f&&h==="asc"?"desc":"asc";a=A,f&&(a=h==="asc"?P:U),n=_,o=b.index.url({mergeQuery:{sort:l,direction:v,page:1,per_page:y||void 0}}),e[0]=l,e[1]=m,e[2]=a,e[3]=n,e[4]=o}else a=e[2],n=e[3],o=e[4];let c;e[5]!==r?(c=t.jsx("span",{children:r}),e[5]=r,e[6]=c):c=e[6];let i;e[7]!==a?(i=t.jsx(a,{className:"h-3.5 w-3.5"}),e[7]=a,e[8]=i):i=e[8];let d;return e[9]!==n||e[10]!==o||e[11]!==c||e[12]!==i?(d=t.jsxs(n,{href:o,className:"inline-flex items-center gap-1",children:[c,i]}),e[9]=n,e[10]=o,e[11]=c,e[12]=i,e[13]=d):d=e[13],d}const $=[{accessorKey:"severity",header:()=>t.jsx(g,{label:"Severity",columnKey:"severity"}),cell:({row:s})=>{const e=s.original.severity,r=e==="critical"?"destructive":e==="warning"?"default":"secondary";return t.jsx(u,{variant:r,children:e.toUpperCase()})}},{accessorKey:"ip_address",header:"IP Address",cell:({row:s})=>t.jsx("span",{className:"font-mono text-sm",children:s.original.ip_address})},{accessorKey:"user",header:"User",cell:({row:s})=>{const e=s.original.user;return e?t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:e.name}),t.jsx("p",{className:"text-xs text-muted-foreground",children:e.email})]}):t.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"endpoint",header:"Endpoint",cell:({row:s})=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(u,{variant:"outline",className:"text-xs",children:s.original.method}),t.jsxs("span",{className:"font-mono text-sm",children:["/",s.original.endpoint]})]})},{accessorKey:"attempts",header:()=>t.jsx(g,{label:"Attempts",columnKey:"attempts"}),cell:({row:s})=>{const e=s.original.attempts,r=e>=100?"text-destructive":e>=50?"text-orange-500":"";return t.jsx("span",{className:`font-bold ${r}`,children:e})}},{accessorKey:"auto_blocked",header:"Auto-Blocked",cell:({row:s})=>s.original.auto_blocked?t.jsx(u,{variant:"destructive",children:"Yes"}):t.jsx("span",{className:"text-muted-foreground text-sm",children:"No"})},{accessorKey:"created_at",header:()=>t.jsx(g,{label:"Time",columnKey:"created_at"}),cell:({row:s})=>(x.extend(w),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm",children:x(s.original.created_at).format("MMM D, HH:mm")}),t.jsx("p",{className:"text-xs text-muted-foreground",children:x(s.original.created_at).fromNow()})]}))}];export{$ as columns};
